# 命令行简介

## **前言**

### **什么是命令行？**

**命令行**（`Command Line Interface`, `CLI`）是一种基于文本的用户界面，用户通过输入文本命令与计算机系统进行交互。它不同于 **图形用户界面**（`Graphical User Interface`, `GUI`），没有窗口、按钮和图标，而是直接输入命令并获取文本反馈。

在命令行环境中，用户可以执行各种操作，如文件管理、进程管理、网络配置、程序运行等。命令行在服务器管理、开发、系统调试等方面非常重要，尤其是在 `Linux` 和 `Unix` 系统中，命令行是主要的操作方式。

### **命令行的组成**

命令行通常由以下部分组成：

1. **Shell**（解释器）：接受用户输入的命令并执行，例如 `Windows` 的 `cmd.exe`、`powershell.exe`，`Linux`/`macOS` 的 `bash`、`zsh`。
2. **命令**：用户输入的指令，例如 `cd`（切换目录）、`ls`（列出文件）。
3. **参数**：为命令提供额外信息，例如 `ls -l`（`-l` 是参数，表示详细列表）。
4. **返回结果**：命令执行后，Shell 会返回输出，例如文件列表、错误信息等。

### **为什么使用命令行？**

1. **更高效**：比 `GUI` 方式更快，例如批量重命名文件、管理系统进程。
2. **更强大**：命令行可以执行许多 `GUI` 无法完成的任务，例如远程管理服务器、编写自动化脚本。
3. **资源占用低**：不需要占用大量系统资源，适用于低性能设备或服务器环境。
4. **自动化能力强**：可以编写脚本实现任务自动化，减少重复性工作。
5. **更灵活的系统管理**：运维、开发人员通常使用命令行进行高效管理。

## **`CMD`**

`CMD`（`Command Prompt`，命令提示符）是 `Windows` 操作系统的传统命令行工具，文件名为 `cmd.exe`，用于执行命令、管理文件和目录、配置系统设置等。`CMD` 使用的是 `DOS` 风格的命令集，相比 `GUI` 具有更高的效率和灵活性，适用于系统管理、批处理脚本编写等任务。

<img src="./命令行简介.assets/image-20250208211836500.png" alt="image-20250208211836500"  />

> 你可以通过以下几种方式打开 `CMD`：
>
> 1. **快捷键**：按 `Win + R`，输入 `cmd`，回车。
> 2. **开始菜单**：在 **Windows 开始菜单** 搜索 `cmd`，点击 **命令提示符** 运行。
> 3. **文件资源管理器**：在任意文件夹地址栏输入 `cmd` 并按 `Enter`，`CMD` 将在该文件夹路径下打开。

> **提示符格式**：`C:\Users\用户名>`（表示当前目录）
>
> **基本输入**：
>
> - 直接输入命令后按 `Enter` 执行。
> - `Tab` 可自动补全文件或目录名称。
> - `↑` `↓` 可浏览历史命令。

### 　**常用 `CMD` 命令**

#### **文件和目录管理**

| 命令             | 作用                       |
| ---------------- | -------------------------- |
| `dir`            | 列出当前目录的文件和文件夹 |
| `cd` / `chdir`   | 切换目录                   |
| `md` / `mkdir`   | 创建新目录                 |
| `rmdir` / `rd`   | 删除目录                   |
| `del` / `erase`  | 删除文件                   |
| `copy`           | 复制文件                   |
| `move`           | 移动文件或重命名           |
| `ren` / `rename` | 重命名文件                 |

**示例**

```cmd
mkdir TestFolder   # 创建文件夹
cd TestFolder      # 进入该文件夹
echo Hello > test.txt  # 创建 test.txt 文件并写入 "Hello"
copy test.txt task.txt # 复制 test.txt
del test.txt     # 删除 test.txt
rmdir TestFolder /s /q  # 删除文件夹及其内容
```

#### **进程和系统管理**

| 命令       | 作用               |
| ---------- | ------------------ |
| `tasklist` | 显示当前运行的进程 |
| `taskkill` | 结束指定进程       |
| `shutdown` | 关机或重启         |
| `cls`      | 清屏               |

 **示例**

```cmd
tasklist        # 查看当前进程
taskkill /F /IM notepad.exe  # 关闭记事本进程
shutdown /s /t 60  # 60 秒后关机
```

#### **磁盘和存储管理**

| 命令       | 作用             |
| ---------- | ---------------- |
| `chkdsk`   | 检查磁盘错误     |
| `format`   | 格式化磁盘       |
| `diskpart` | 进入磁盘管理工具 |

**示例**

```
chkdsk C:  # 检查 C 盘错误
format D:  # 格式化 D 盘
diskpart   # 进入磁盘管理工具
```

#### **网络管理**

| 命令       | 作用             |
| ---------- | ---------------- |
| `ping`     | 测试网络连通性   |
| `ipconfig` | 查看 IP 地址信息 |
| `netstat`  | 查看网络连接     |
| `tracert`  | 跟踪数据包路径   |
| `nslookup` | 查询域名解析结果 |

**示例**

```cmd
ping 8.8.8.8  # 测试到 Google DNS 的网络连接
ipconfig /all # 查看本机详细网络信息
netstat -an   # 显示当前所有网络连接
```

#### **用户和权限管理**

| 命令             | 作用          |
| ---------------- | ------------- |
| `whoami`         | 显示当前用户  |
| `net user`       | 显示/管理用户 |
| `net localgroup` | 管理用户组    |

**示例**

```cmd
whoami  # 查看当前登录用户
net user testuser mypassword /add  # 创建用户 testuser
net localgroup administrators testuser /add  # 赋予管理员权限
```

### **`CMD` 批处理（`Batch`）脚本**

`CMD` 批处理（`Batch`）脚本可自动执行一系列命令，文件扩展名为 `.bat`，起源于 `DOS` 时代。

## **`PowerShell`**

`PowerShell` 是由微软开发的命令行界面和脚本语言，最初发布于 2006 年。它与传统的 Windows CMD 命令行工具不同，提供了更强大的功能、脚本编程能力，并且能够与 .NET 框架进行深度集成。PowerShell 旨在通过对象而非文本进行操作，使得任务的自动化、系统管理、网络管理等变得更加高效和灵活。

> **`PowerShell` 与 `CMD` 的不同**
>
> - **`CMD`**：基于文本的命令行工具，执行命令后返回纯文本。
> - **`PowerShell`**：基于对象的命令行工具，执行命令后返回对象，用户可以操作和处理这些对象。

### **`PowerShell` 的基本概念**

#### **命令（`Cmdlet`）**

`PowerShell` 中的命令被称为 **`cmdlet`**（发音为 "`command-let`"），它是 `PowerShell` 的核心部分。`Cmdlet` 是小型、单一功能的命令，通常采用动词-名词的命名规则。

例如：

- `Get-Process`：获取当前系统的进程信息。
- `Set-Item`：设置项（例如文件或注册表键值）。

#### **管道（`Pipeline`）**

`PowerShell` 使用管道将一个命令的输出传递给另一个命令的输入。管道传递的是对象，而不仅仅是文本。通过管道，用户可以将多个 `cmdlet` 组合起来，实现复杂的操作。

例如：

```powershell
Get-Process | Where-Object { $_.CPU -gt 100 } | Sort-Object CPU
```

这条命令会列出 CPU 使用率大于 100 的进程，并按 CPU 使用率排序。

#### **对象**

与 `CMD` 仅处理文本不同，`PowerShell` 中的管道和命令处理的是 **对象**，这些对象可以是任何 .NET 类型，如字符串、数字、文件、进程等。对象具有属性和方法，因此你可以很方便地访问和操作它们。

#### **变量**

`PowerShell` 中的变量以 `$` 符号开头，例如 `$var`，并且它们可以存储各种类型的对象。`PowerShell` 会自动根据赋值内容推断变量类型。

例如：

```powershell
$process = Get-Process
$process.Name  # 获取进程的名称
```

### **常用 PowerShell 命令（Cmdlet）**

#### **文件和目录管理**

| 命令            | 作用                                       |
| --------------- | ------------------------------------------ |
| `Get-ChildItem` | 列出当前目录或指定目录下的所有文件和子目录 |
| `Set-Location`  | 改变当前工作目录（类似 `cd`）              |
| `New-Item`      | 创建文件或目录                             |
| `Remove-Item`   | 删除文件或目录                             |
| `Copy-Item`     | 复制文件或目录                             |
| `Move-Item`     | 移动或重命名文件或目录                     |
| `Rename-Item`   | 重命名文件或目录                           |

**示例**

```powershell
Get-ChildItem C:\Windows  # 列出 C:\Windows 目录下的文件
Set-Location C:\Users     # 切换到 C:\Users 目录
New-Item -Path C:\Temp -Name "test.txt" -ItemType "File"  # 创建新文件
Copy-Item C:\test.txt C:\Backup\test.txt  # 复制文件
Remove-Item C:\test.txt  # 删除文件
```

------

#### **进程和服务管理**

| 命令            | 作用               |
| --------------- | ------------------ |
| `Get-Process`   | 获取当前运行的进程 |
| `Stop-Process`  | 停止指定进程       |
| `Start-Process` | 启动新进程         |
| `Get-Service`   | 获取系统服务列表   |
| `Stop-Service`  | 停止指定服务       |
| `Start-Service` | 启动指定服务       |

**示例**

```powershell
Get-Process  # 获取当前系统进程列表
Stop-Process -Name "notepad"  # 结束记事本进程
Start-Process "notepad.exe"  # 启动记事本
Get-Service  # 获取所有服务的状态
Stop-Service -Name "Spooler"  # 停止打印服务
```

------

#### **网络管理**

| 命令               | 作用                                    |
| ------------------ | --------------------------------------- |
| `Test-Connection`  | 测试与远程主机的网络连接（类似 `ping`） |
| `Get-NetIPAddress` | 获取 `IP` 地址信息                      |
| `Get-NetAdapter`   | 获取网络适配器信息                      |

**示例**

```powershell
Test-Connection 8.8.8.8  # 测试与 Google DNS 的连接
Get-NetIPAddress  # 获取当前网络配置
Get-NetAdapter  # 获取网络适配器状态
```

------

### **`PowerShell` 脚本**

`PowerShell` 支持强大的脚本编写功能，可以使用 `PowerShell` 脚本自动执行任务。PowerShell 脚本使用 `.ps1` 扩展名。

**示例**

```powershell
# 简单的 PowerShell 脚本：检查指定目录是否存在，如果不存在则创建
$path = "C:\TestDirectory"
if (-not (Test-Path $path)) {
    New-Item -Path $path -ItemType Directory
    Write-Host "目录已创建"
} else {
    Write-Host "目录已存在"
}
```

## **Linux 命令行**

`Linux` 命令行是 `Linux` 操作系统中最基本的交互界面之一，它允许用户通过输入命令来执行各种任务，管理系统，运行程序，处理文件等。与传统的图形界面（GUI）不同，命令行（`CLI`，`Command Line Interface`）依赖于用户通过键盘输入文本命令来与系统交互。

### **`Linux` 命令行简介**

`Linux` 命令行是一个强大的工具，广泛用于系统管理、文件操作、进程管理、网络管理等。它具有非常高的灵活性和可定制性，支持脚本编程，用户可以通过编写 shell 脚本来自动化日常任务。

### **命令行 `Shell`**

Linux 系统中的命令行是通过一个称为 **shell** 的程序提供的，shell 是用户与操作系统之间的接口，负责接收用户输入并执行相应的命令。

常见的 Linux Shell 包括：

- **Bash**（Bourne Again Shell）：最常用的 Linux Shell，兼容 Bourne Shell，拥有强大的功能。
- **Zsh**（Z Shell）：功能强大，具有更好的自动补全、命令历史、插件支持等特性。
- **Fish**（Friendly Interactive Shell）：更加现代化，提供直观的提示和强大的自动补全功能。
- **Sh**（Bourne Shell）：Linux 中的传统 Shell，常见于脚本中。

### **常用 Linux 命令**

#### **文件和目录管理**

| 命令    | 作用                       |
| ------- | -------------------------- |
| `ls`    | 列出目录内容               |
| `cd`    | 改变目录                   |
| `pwd`   | 显示当前目录的绝对路径     |
| `mkdir` | 创建目录                   |
| `rmdir` | 删除空目录                 |
| `rm`    | 删除文件或目录             |
| `cp`    | 复制文件或目录             |
| `mv`    | 移动文件或目录（或重命名） |
| `touch` | 创建空文件或更新文件时间戳 |
| `find`  | 在目录树中查找文件         |

**示例**

```bash
ls -l            # 列出当前目录下的详细文件列表
cd /home/user    # 切换到指定目录
pwd              # 显示当前工作目录
mkdir myfolder   # 创建目录 myfolder
rmdir myfolder   # 删除空目录 myfolder
rm -r folder     # 删除非空目录 folder
cp source.txt destination.txt  # 复制文件
mv oldname.txt newname.txt     # 重命名文件
touch newfile.txt  # 创建一个空文件
find /home -name "*.txt"  # 查找所有 .txt 文件
```

------

#### **文件查看和编辑**

| 命令         | 作用                             |
| ------------ | -------------------------------- |
| `cat`        | 显示文件内容                     |
| `less`       | 分页显示文件内容（支持上下翻页） |
| `more`       | 分页显示文件内容                 |
| `head`       | 显示文件的前 n 行                |
| `tail`       | 显示文件的后 n 行                |
| `nano`       | 终端文本编辑器                   |
| `vim` / `vi` | 高级文本编辑器                   |

 **示例**

```bash
cat file.txt      # 显示 file.txt 文件内容
less file.txt     # 分页显示 file.txt 文件
head -n 10 file.txt   # 显示文件的前 10 行
tail -n 10 file.txt   # 显示文件的后 10 行
nano file.txt     # 使用 nano 编辑文件
vim file.txt      # 使用 vim 编辑文件
```

------

#### **文件权限管理**

| 命令    | 作用                   |
| ------- | ---------------------- |
| `chmod` | 更改文件或目录的权限   |
| `chown` | 更改文件或目录的所有者 |
| `chgrp` | 更改文件或目录的用户组 |
| `umask` | 设置默认文件创建权限   |

**示例**

```bash
chmod 755 file.txt    # 设置文件权限为 rwx-r-xr-x
chown user:group file.txt  # 更改文件的所有者和用户组
chgrp group file.txt  # 更改文件的用户组
umask 022             # 设置默认创建文件的权限
```

------

#### **进程管理**

| 命令      | 作用                 |
| --------- | -------------------- |
| `ps`      | 查看当前运行的进程   |
| `top`     | 动态显示进程信息     |
| `kill`    | 终止进程             |
| `killall` | 根据进程名称终止进程 |
| `bg`      | 将任务移至后台运行   |
| `fg`      | 将后台任务调回前台   |

 **示例**

```bash
ps aux              # 显示所有运行的进程
top                 # 实时显示系统的进程和资源使用情况
kill 12345          # 结束进程号为 12345 的进程
killall firefox     # 终止所有名为 firefox 的进程
bg %1               # 将任务 1 放到后台
fg %1               # 将任务 1 调回前台
```

------

#### **网络管理**

| 命令       | 作用                                |
| ---------- | ----------------------------------- |
| `ping`     | 测试网络连接                        |
| `ifconfig` | 查看和配置网络接口（旧版）          |
| `ip`       | 配置网络接口（现代替代 `ifconfig`） |
| `netstat`  | 显示网络连接、路由表等信息          |
| `ssh`      | 安全远程登录                        |
| `scp`      | 安全拷贝文件                        |
| `wget`     | 从网络下载文件                      |

**示例**

```bash
ping 8.8.8.8        # 测试与 Google DNS 的网络连接
ifconfig            # 显示网络接口信息
ip addr show        # 显示网络接口的详细信息
netstat -tuln       # 显示所有监听的端口
ssh user@hostname   # 远程登录到主机
scp file.txt user@hostname:/path/to/destination  # 安全复制文件
wget http://example.com/file.txt  # 从指定 URL 下载文件
```

------

#### **用户和组管理**

| 命令       | 作用               |
| ---------- | ------------------ |
| `useradd`  | 创建新用户         |
| `usermod`  | 修改用户信息       |
| `userdel`  | 删除用户           |
| `groupadd` | 创建新用户组       |
| `groupdel` | 删除用户组         |
| `passwd`   | 设置或修改用户密码 |

 **示例**

```bash
useradd newuser           # 创建新用户
usermod -aG sudo newuser  # 将用户添加到 sudo 组
userdel newuser           # 删除用户
groupadd newgroup         # 创建新用户组
groupdel oldgroup         # 删除用户组
passwd newuser            # 设置新用户密码
```

------

### **Linux 命令行的高级特性**

#### **管道与重定向**

Linux 命令行的强大之处在于其能够将命令的输出通过管道传递给另一个命令，实现灵活的组合操作。

- **管道（|）**：将一个命令的输出作为另一个命令的输入。
- **重定向（>、>>）**：将输出重定向到文件中。

**示例**

```bash
ls -l | grep "txt"        # 列出文件并筛选出包含 "txt" 的文件
echo "Hello, World!" > output.txt  # 将文本输出到文件
cat output.txt >> append.txt       # 将内容追加到文件
```

#### **命令别名与函数**

可以通过设置命令别名（alias）或编写 shell 函数来简化命令操作，提升效率。

 **示例**

```bash
alias ll='ls -l'      # 创建别名 ll 等价于 ls -l
function greet() {    # 创建一个函数
  echo "Hello, $1!"
}
greet World           # 调用函数，输出 "Hello, World!"
```
